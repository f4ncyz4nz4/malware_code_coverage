from minidump import minidumpfile, minidumpreader
from capstone import *
import re

minidump_file = minidumpfile.MinidumpFile.parse(
    "./bho/coverage/1d713ad7ee3a43432d6188707943ee9ef07241bbc7bda376a068989d7a248143.dat-7700.dmp")
print(minidump_file)
minidump_reader = minidump_file.get_reader()
mod = minidump_reader.get_module_by_name("")
print(mod)

# d = {}
md = Cs(CS_ARCH_X86, CS_MODE_32)

# for ms in minidump_reader.get_memory():
#   d.update({ms.start_virtual_address: ms.size})
#   d = dict(sorted(d.items()))

# to search in memory based on pattern
# addr = minidump_reader.search(b'\xe5\x89\x55')
# for a in addr:
#    print(hex(a))

# to read from memory
code = minidump_reader.read(0x00401070, 0x1000)
print(code)
