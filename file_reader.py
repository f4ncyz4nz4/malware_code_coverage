from minidump import minidumpfile, minidumpreader
from capstone import *

md = Cs(CS_ARCH_X86, CS_MODE_32)
minidump_file = minidumpfile.MinidumpFile.parse(
    "./1d713ad7ee3a43432d6188707943ee9ef07241bbc7bda376a068989d7a248143.dmp")
print(minidump_file)
minidump_reader = minidump_file.get_reader()
mod = minidump_reader.get_module_by_name("")
print(mod)

# code = minidump_reader.read(0x4038e8, 0x200)
# for i in md.disasm(code, 0x4038e8):
#    print("0x%x:\t%s\t%s" % (i.address, i.mnemonic, i.op_str))
