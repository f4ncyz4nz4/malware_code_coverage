import pickle

# Starts execution here
if __name__ == "__main__":
    monitor = getMonitor()
    ext = {}
    for e in currentProgram.getListing().getExternalFunctions():
        addr = e.getSymbol().getReferences()[0].getFromAddress().toString()
        print(addr)
        ext[addr] = e.toString()

    with open("externals.pickle", "wb") as file:
        pickle.dump(ext, file)
# /opt/ghidra_10.2.2/support/analyzeHeadless . CodeCoverage -import /home/ippo/Desktop/malware_code_coverage_project/1d713ad7ee3a43432d6188707943ee9ef07241bbc7bda376a068989d7a248143.exe -scriptPath /home/ippo/Desktop/malware_code_coverage_project/malware_code_coverage/ -postscript exe.py -deleteProject
